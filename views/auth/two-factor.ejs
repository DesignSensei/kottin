<!-- views/auth/two-factor.ejs -->

<!-- Form Column -->
<div
  data-w-id="9fa109aa-712e-b709-7fec-65d08001e45f"
  class="content-center-tablet"
  style="opacity: 0; transform: translate3d(0, 10%, 0) scale3d(1, 1, 1)"
>
  <h2 class="display-8 mg-top-default" style="color: rgb(14, 24, 16); margin-bottom: 20px">
    Two-Factor Verification
  </h2>

  <div>
    <p class="paragraph-large" style="margin-bottom: 32px">
      Enter the verification code we sent to your email
    </p>
  </div>

  <div id="login-form-wrapper" class="form-wrapper width-320px">
    <form id="two-factor-form" action="/two-factor" method="POST" aria-label="Two-Factor VerifyS">
      <!-- CSRF Token -->
      <input type="hidden" name="_csrf" value="<%= csrfToken %>" />
      <!-- Hidden field that external JS will populate -->
      <input type="hidden" name="code" id="otp-hidden-code" />

      <!-- OTP Input -->
      <div class="inner-container _487px _100-tablet">
        <div class="otp-container">
          <% for (let i = 0; i < 6; i++) { %>
          <input
            class="otp-input"
            type="text"
            inputmode="numeric"
            pattern="[0-9]"
            maxlength="1"
            name="digit<%= i %>"
            autocomplete="one-time-code"
            aria-label="Digit <%= i+1 %>"
            required
          />
          <% } %>
        </div>
      </div>

      <!-- Submit Button -->
      <div class="buttons-row left mg-top-default">
        <button type="submit" id="primary-button" class="primary-button-2 w-button">Verify</button>
      </div>
    </form>

    <p class="paragraph-large" style="text-align: center; margin-top: 20px">
      Didn't get an email?
      <button
        type="button"
        id="resend-btn"
        class="primary-link"
        style="
          text-decoration: none;
          color: #6a14f2;
          background: none;
          border: none;
          padding: 0;
          cursor: pointer;
          display: inline;
        "
      >
        Resend
      </button>
    </p>
  </div>
</div>
